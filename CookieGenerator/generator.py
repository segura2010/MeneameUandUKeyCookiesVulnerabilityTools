import md5
import base64
import sys
import time

def generateUCookie(uid, timestamp, site_key):
	cookie_u = uid + ":" + uid + ":" + timestamp
	signature = md5.new(cookie_u + str(site_key)).hexdigest()[:8]
	cookie_u = cookie_u + ":" + signature
	return cookie_u

def generateUKeyCookie(uid, email, username, timestamp, site_key):
	key = md5.new(email + str(site_key) + username + uid + timestamp).hexdigest()

	cookie_ukey = uid + ":" + key + ":" + "6" + ":" + timestamp + ":" + "0"
	# print "Plain: ", cookie_ukey
	cookie_ukey = base64.b64encode(cookie_ukey)
	return cookie_ukey

if len(sys.argv) < 5:
	print "Usage: ", sys.argv[0], " email username user_id sitekey"
	exit(0)


site_key = sys.argv[4]
email = sys.argv[1]
username = sys.argv[2]
uid = sys.argv[3]
timestamp = str(int(time.time()))

# Generate u
cookie_u = generateUCookie(uid, timestamp, site_key)
print "u=", cookie_u

cookie_ukey = generateUKeyCookie(uid, email, username, timestamp, site_key)
print "ukey=", cookie_ukey


